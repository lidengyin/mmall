webpackJsonp([4],{"2w1R":function(t,e,i){"use strict";var n=i("Xxa5"),r=i.n(n),a=i("mtWM"),s=i.n(a);var o={name:"UE",data:function(){return{editor:null,jwt:"",config:"",contenturl:"",content:"",content1:""}},created:function(){var t,e=this;return(t=r.a.mark(function t(){return r.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:e.init();case 1:case"end":return t.stop()}},t,e)}),function(){var e=t.apply(this,arguments);return new Promise(function(t,i){return function n(r,a){try{var s=e[r](a),o=s.value}catch(t){return void i(t)}if(!s.done)return Promise.resolve(o).then(function(t){n("next",t)},function(t){n("throw",t)});t(o)}("next")})})()},mounted:function(){},methods:{init:function(){var t=this,e="";s.a.get("http://47.112.132.177:8250/ueditor").then(function(i){e=i.data,console.log(e),e.initialFrameWidth="100%",e.initialFrameHeight=300,e.maximumWords=1e5;var n=t;t.editor=UE.getEditor("editor",e),t.editor.ready(function(){UE.getEditor("editor").addListener("contentChange",function(){n.content=UE.getEditor("editor").getContent(),n.content1=UE.getEditor("editor").getContentTxt()})}),UE.Editor.prototype._bkGetActionUrl=UE.Editor.prototype.getActionUrl,UE.Editor.prototype.getActionUrl=function(t){return"uploadimage"==t||"uploadscrawl"==t||"uploadimage"==t?"http://47.112.132.177:8250/imgUpload":"uploadvideo"==t?"http://47.112.132.177:8250/videoUpload":"uploadfile"==t?"http://47.112.132.177:8250/fileUpload":this._bkGetActionUrl.call(this,t)}})},clearContent:function(){return this.content1="",this.content="",this.contenturl="",this.editor.execCommand("cleardoc")}},beforeDestroy:function(){null!==this.editor&&this.editor.destroy&&this.editor.destroy()}},c={render:function(){this.$createElement;this._self._c;return this._m(0)},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",[e("div",{staticClass:"uEditor"},[e("div",{attrs:{id:"editor",type:"text/plain"}})])])}]};var u=i("VU/8")(o,c,!1,function(t){i("L9x+")},null,null);e.a=u.exports},"31jr":function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i("Xxa5"),r=i.n(n),a=i("2w1R"),s=i("W118"),o=i("D2Ra");var c={mounted:function(){},data:function(){return{imgsUrl:[],dialogImageUrl:"",dialogVisible:!1}},methods:{setList:function(t){for(var e=0;e<t.length;e++)this.imgsUrl.push({name:"img"+e,url:t[e]})},handleChange:function(t,e){var i,n=this;return(i=r.a.mark(function e(){var i,a,s;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(n.imgsUrl.length<5)){e.next=11;break}if(!(t.size/1024/1024<2)){e.next=10;break}return(i=new FormData).append("upload_file",t.raw),e.next=6,Object(o.S)(i);case 6:0==(a=e.sent).status&&(s=a.data.url,console.log(t),n.imgsUrl.push({name:t.name,uid:t.uid,url:s}),console.log(n.imgsUrl)),e.next=11;break;case 10:n.$message({message:"请上传小于2M的图片",type:"warning",duration:"1500"});case 11:case"end":return e.stop()}},e,n)}),function(){var t=i.apply(this,arguments);return new Promise(function(e,i){return function n(r,a){try{var s=t[r](a),o=s.value}catch(t){return void i(t)}if(!s.done)return Promise.resolve(o).then(function(t){n("next",t)},function(t){n("throw",t)});e(o)}("next")})})()},handleRemove:function(t,e){this.imgsUrl=this.imgsUrl.filter(function(e){return e.uid!==t.uid})},handlePictureCardPreview:function(t){this.dialogImageUrl=t.url,this.dialogVisible=!0},beforeUpload:function(t){return!0},clearAll:function(){this.$refs.upload.clearFiles(),this.imageUrl=[],this.dialogImageUrl="",this.dialogVisible=!1}}},u={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"uploadImages"},[i("el-upload",{ref:"upload",attrs:{action:"api/elegant/upload","list-type":"picture-card","file-list":t.imgsUrl,"before-upload":t.beforeUpload,"on-change":t.handleChange,"auto-upload":!1,accept:"image/*","on-preview":t.handlePictureCardPreview,"on-remove":t.handleRemove,limit:5}},[i("i",{staticClass:"el-icon-plus"})]),t._v(" "),i("el-dialog",{attrs:{visible:t.dialogVisible},on:{"update:visible":function(e){t.dialogVisible=e}}},[i("img",{attrs:{width:"100%",src:t.dialogImageUrl,alt:""}})])],1)},staticRenderFns:[]};var l=i("VU/8")(c,u,!1,function(t){i("QpqO")},null,null).exports,d=i("NYxO"),p=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var i=arguments[e];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}return t};function h(t){return function(){var e=t.apply(this,arguments);return new Promise(function(t,i){return function n(r,a){try{var s=e[r](a),o=s.value}catch(t){return void i(t)}if(!s.done)return Promise.resolve(o).then(function(t){n("next",t)},function(t){n("throw",t)});t(o)}("next")})}}var m={data:function(){return{editor:null,config:"",myGood:"",types:"",name:"",subtitle:"",subImages:"",detail:"",price:"",stock:"",categoryId:[],typesName:[],loading:!1}},components:{Ueditor:a.a,Tag:s.a,UploadImg:l},computed:p({},Object(d.c)([""])),created:function(){this.$route.query.id?(this.id=1*JSON.parse(this.$route.query.id),this.reqTypes(),this.choiceMenuId("goodList"),this.changePathNames([{name:"商品管理"},{name:"商品列表",path:"goodList"},{name:"商品更新"}])):this.$router.replace({name:"goodList"})},methods:p({},Object(d.b)(["choiceMenuId","changePathNames"]),{reqTypes:function(){var t=this;return h(r.a.mark(function e(){var i,n;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i=0,e.next=3,Object(o.r)({categoryId:i});case 3:0===(n=e.sent).status&&(t.types=n.data,t.reqGoodDetail(t.id));case 5:case"end":return e.stop()}},e,t)}))()},reqGoodDetail:function(t){var e=this;return h(r.a.mark(function i(){var n;return r.a.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,Object(o.p)({productId:t});case 2:0===(n=i.sent).status?(e.myGood=n.data,e.init(e.myGood)):e.message(n.msg,1500,"error");case 4:case"end":return i.stop()}},i,e)}))()},init:function(t){var e=this;this.name=t.name,this.subtitle=t.subtitle,this.subImages=t.subImages.split(","),this.price=1*t.price,this.stock=1*t.stock,this.categoryId=t.categoryId,this.types.map(function(t){t.id==e.categoryId&&e.typesName.push({id:t.id,name:t.name})}),this.$refs.mainImages.setList(this.subImages);var i=this;setTimeout(function(){i.$refs.ueditor.editor.setContent(t.detail)},2e3)},updata:function(){var t=this;return h(r.a.mark(function e(){var i,n,a,s,c,u,l,d,p,h,m,f;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t.detail=t.$refs.ueditor.content,i=t.$refs.mainImages.imgsUrl,n=t.detail,a=t.stock,s=t.price,c=t.subtitle,u=t.name,l=t.categoryId,d=t.id,!(n&&i.length>0&&a&&s&&c&&u&&l)){e.next=24;break}return p=i,t.subImages="",p.map(function(e){return t.subImages=t.subImages+e.url+","}),t.subImages=t.subImages.slice(0,t.subImages.length-1),h=t.subImages,(m=new FormData).append("id",d),m.append("detail",n),m.append("subImages",h),m.append("stock",a),m.append("price",s),m.append("subtitle",c),m.append("name",u),m.append("categoryId",l),e.next=20,Object(o.Q)(m);case 20:0===(f=e.sent).status?(t.clearAll(),t.message("商品修改成功",1200,"success"),setTimeout(function(){t.$router.push({name:"goodList"})},1500)):t.message(f.msg,1200,"error"),e.next=25;break;case 24:t.message("请输入完整商品信息",1200,"warning");case 25:case"end":return e.stop()}},e,t)}))()},choiceType:function(t,e){if(this.categoryId.length<1){for(var i=!1,n=0;n<this.categoryId.length;n++)if(this.categoryId[n]==t)return void(i=!0);i||(this.categoryId.push(t),this.typesName.push({id:t,name:e}))}else this.$message({message:"一件商品最多添加1个类型",duration:1e3,type:"warning"})},outType:function(t){this.categoryId=[],this.typesName=this.typesName.filter(function(e){return e.id!==t})},message:function(t,e,i){this.$message({message:t,duration:e,type:i})},clearAll:function(){this.name="",this.subtitle="",this.subImages="",this.detail="",this.price="",this.stock="",this.status="",this.categoryId=[],this.typesName=[],this.$refs.ueditor.clearContent(),this.$refs.mainImages.clearAll()}}),watch:{detail:function(t,e){t.trim().length>500&&(this.detail=t.slice(0,500))},price:function(t,e){var i=t+"",n=i.substr(0,1),r=i.substr(1,1);if(i.length>1&&0==n&&"."!=r&&(i=i.substr(1,1)),"."==n&&(i=""),-1!=i.indexOf(".")){var a=i.substr(i.indexOf(".")+1);-1!=a.indexOf(".")&&(i=i.substr(0,i.indexOf(".")+a.indexOf(".")+1))}i=i.replace(/[^\d^\.]+/g,""),/\.\d\d\d$/.test(i)&&(i=i.slice(0,i.indexOf(".")+3)),this.price=i}}},f={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"updateGood"},[i("form",{staticClass:"updateform"},[i("div",{staticClass:"form-group"},[t._m(0),t._v(" "),i("el-input",{attrs:{type:"text",placeholder:"请输入商品名称,最多50个字。",id:"shopName",maxlength:"50","show-word-limit":""},model:{value:t.name,callback:function(e){t.name=e},expression:"name"}})],1),t._v(" "),i("div",{staticClass:"form-group"},[t._m(1),t._v(" "),i("el-input",{attrs:{type:"text",placeholder:"请输入商品名称,最多50个字。",id:"subtitleName",maxlength:"50","show-word-limit":""},model:{value:t.subtitle,callback:function(e){t.subtitle=e},expression:"subtitle"}})],1),t._v(" "),i("div",{staticClass:"form-group"},[t._m(2),t._v(" "),i("el-input",{attrs:{type:"text",placeholder:"请输入商品单价（例如500.00）",id:"shopPrice"},model:{value:t.price,callback:function(e){t.price=e},expression:"price"}})],1),t._v(" "),i("div",{staticClass:"form-group"},[t._m(3),t._v(" "),i("el-input",{attrs:{type:"text",placeholder:"请输入商品库存（例如500）",id:"shopStock",oninput:"value=value.replace(/[^\\d]/g,'')"},model:{value:t.stock,callback:function(e){t.stock=e},expression:"stock"}})],1),t._v(" "),i("div",{staticClass:"form-group"},[t._m(4),t._v(" "),i("div",[i("div",{staticClass:"input-group"},[i("div",{staticClass:"input-group-btn"},[t._m(5),t._v(" "),i("ul",{directives:[{name:"show",rawName:"v-show",value:t.types,expression:"types"}],staticClass:"dropdown-menu"},t._l(t.types,function(e,n){return e.status?i("li",{key:n},[i("a",{attrs:{href:"javascript:;"},on:{click:function(){return t.choiceType(e.id,e.name)}}},[t._v(t._s(e.name))])]):t._e()}),0)]),t._v(" "),i("Tag",{attrs:{typesname:t.typesName},on:{outtype:t.outType}})],1)])]),t._v(" "),i("div",{staticClass:"form-group"},[t._m(6),t._v(" "),i("UploadImg",{ref:"mainImages"})],1),t._v(" "),i("div",{staticClass:"form-group"},[t._m(7),t._v(" "),i("Ueditor",{ref:"ueditor"})],1),t._v(" "),i("el-button",{attrs:{id:"updateButton"},on:{click:t.updata}},[t._v("确认修改")])],1)])},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("label",{attrs:{for:"shopName"}},[e("i",{staticStyle:{color:"red","margin-right":"5px"}},[this._v("*")]),this._v("商品名称：")])},function(){var t=this.$createElement,e=this._self._c||t;return e("label",{attrs:{for:"subtitleName"}},[e("i",{staticStyle:{color:"red","margin-right":"5px"}},[this._v("*")]),this._v("商品副标题：")])},function(){var t=this.$createElement,e=this._self._c||t;return e("label",{attrs:{for:"shopPrice"}},[e("i",{staticStyle:{color:"red","margin-right":"5px"}},[this._v("*")]),this._v("商品单价：")])},function(){var t=this.$createElement,e=this._self._c||t;return e("label",{attrs:{for:"shopStock"}},[e("i",{staticStyle:{color:"red","margin-right":"5px"}},[this._v("*")]),this._v("商品库存：")])},function(){var t=this.$createElement,e=this._self._c||t;return e("label",[e("i",{staticStyle:{color:"red","margin-right":"5px"}},[this._v("*")]),this._v("商品类型：")])},function(){var t=this.$createElement,e=this._self._c||t;return e("button",{staticClass:"btn btn-default dropdown-toggle",staticStyle:{"margin-right":"15px"},attrs:{type:"button","data-toggle":"dropdown","aria-haspopup":"true","aria-expanded":"false"}},[this._v("选择类型 "),e("span",{staticClass:"caret"})])},function(){var t=this.$createElement,e=this._self._c||t;return e("label",[e("i",{staticStyle:{color:"red","margin-right":"5px"}},[this._v("*")]),this._v("图片(最多五张，第一张为主图)：")])},function(){var t=this.$createElement,e=this._self._c||t;return e("label",[e("i",{staticStyle:{color:"red","margin-right":"5px"}},[this._v("*")]),this._v("商品介绍：")])}]};var g=i("VU/8")(m,f,!1,function(t){i("aJnH")},null,null);e.default=g.exports},"L9x+":function(t,e){},QpqO:function(t,e){},W118:function(t,e,i){"use strict";var n={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"tag"},t._l(t.typesname,function(e){return i("el-tag",{key:e.id,attrs:{closable:""},on:{close:function(i){return t.handleClose(e.id)}}},[t._v("\n    "+t._s(e.name)+"\n  ")])}),1)},staticRenderFns:[]};var r=i("VU/8")({data:function(){return{}},props:["typesname"],mounted:function(){},methods:{handleClose:function(t){this.$emit("outtype",t)}}},n,!1,function(t){i("uS0b")},null,null);e.a=r.exports},aJnH:function(t,e){},uS0b:function(t,e){}});